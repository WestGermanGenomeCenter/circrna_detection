Building DAG of jobs...
Job counts:
	count	jobs
	2	_cx_b_prepare_files
	2	_cx_c_align_primary_STAR
	2	_cx_d_run_cx2
	2	_cx_e_annotate_circs
	2	_cx_f_cleanup_cx2anot
	2	_dcc_b_prepare_files_dcc
	2	_dcc_c_align_primary_STAR_DCC
	2	_dcc_d1_align_mate1
	2	_dcc_d2_align_mate2
	2	_dcc_e_execute_dcc
	2	_dcc_f_cleanup_circfile
	2	_dcc_g_annotate_cleanfile
	2	_dcc_h_cleanup_annotation
	2	_fc_b_prepare_files_fc
	2	_fc_c_map_primary_bt2
	2	_fc_d_create_bam
	2	_fc_e_sort_bam
	2	_fc_f_prepare_remapping
	2	_fc_g_get_anchors
	2	_fc_h_align_anchors
	2	_fc_i_filter_fc
	2	_fc_j_annotate_candidates_fc
	2	_fc_k_reformat_circs
	1	_r01_prepare_hg38_dirs
	1	_r02_create_fastq_list
	1	_r03_create_infile
	1	_r04_count_reads_fastqs
	1	_r05a_collect_tsvs_fc
	1	_r05b_collect_tsvs_dc
	1	_r05c_collect_tsvs_cx
	1	_r06a_run_matrixmaker_fc
	1	_r06b_run_matrixmaker_dc
	1	_r06c_run_matrixmaker_cx
	1	_r07a_run_matrix2_fc
	1	_r07b_run_matrix2_dc
	1	_r07c_run_matrix2_cx
	1	all
	60

rule _r01_prepare_hg38_dirs:
    input: run_conf.yaml
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/chk.tx
    jobid: 28
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/chk.tx

mkdir -p /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples && touch /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/chk.tx /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/chk.tx /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/chk.tx

rule _dcc_b_prepare_files_dcc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx
    jobid: 47
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx
    wildcards: name=SRR3184300

mkdir -p /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/ && cd /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/ && touch /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx

rule _cx_b_prepare_files:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/chk.tx
    jobid: 45
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/chk.tx
    wildcards: name=SRR3184300

mkdir -p /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/ && cd /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/ && touch /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/chk.tx

rule _dcc_b_prepare_files_dcc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx
    jobid: 46
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx
    wildcards: name=SRR3184285

mkdir -p /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/ && cd /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/ && touch /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx

rule _cx_b_prepare_files:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/chk.tx
    jobid: 44
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/chk.tx
    wildcards: name=SRR3184285

mkdir -p /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/ && cd /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/ && touch /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/chk.tx

rule _fc_b_prepare_files_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/chk.tx
    jobid: 58
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/chk.tx
    wildcards: name=SRR3184300

mkdir -p /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/ && cd /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/ && touch /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/chk.tx

rule _fc_b_prepare_files_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/chk.tx
    jobid: 59
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/chk.tx
    wildcards: name=SRR3184285

mkdir -p /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/ && cd /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/ && touch /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/chk.tx

rule _cx_c_align_primary_STAR:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/Chimeric.out.junction
    jobid: 35
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/Chimeric.out.junction; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/chk.tx
    wildcards: name=SRR3184300

STAR --runThreadN 1 --genomeDir /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full --readFilesIn /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq --chimSegmentMin 10 --limitBAMsortRAM 512000000000 

rule _fc_c_map_primary_bt2:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.sam
    jobid: 56
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.sam; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/chk.tx
    wildcards: name=SRR3184300

bowtie2 -p 1 --very-sensitive --mm --score-min=C,-15,0 -x /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg19 -1 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq -2 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq 2>/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/bt2_first_align.log >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.sam

rule _cx_c_align_primary_STAR:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/Chimeric.out.junction
    jobid: 34
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/Chimeric.out.junction; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/chk.tx
    wildcards: name=SRR3184285

STAR --runThreadN 1 --genomeDir /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full --readFilesIn /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq --chimSegmentMin 10 --limitBAMsortRAM 512000000000 

rule _fc_c_map_primary_bt2:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.sam
    jobid: 57
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.sam; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/chk.tx
    wildcards: name=SRR3184285

bowtie2 -p 1 --very-sensitive --mm --score-min=C,-15,0 -x /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg19 -1 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq -2 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq 2>/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/bt2_first_align.log >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.sam

rule _r02_create_fastq_list:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/fastq_infiles_list.tx
    jobid: 19
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/fastq_infiles_list.tx; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/chk.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/chk.tx

 cd /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs && ls -f1 *.fastq >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/fastq_infiles_list.tx

rule _dcc_c_align_primary_STAR_DCC:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_bothlanes.Chimeric.out.junction
    jobid: 36
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_bothlanes.Chimeric.out.junction; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx
    wildcards: name=SRR3184285

STAR --runThreadN 1 --genomeDir /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full --outSAMtype BAM SortedByCoordinate --readFilesIn /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq --outFileNamePrefix SRR3184285_bothlanes. --outReadsUnmapped Fastx --outSJfilterOverhangMin 15 15 15 15 --alignSJoverhangMin 15 --alignSJDBoverhangMin 15 --outFilterMultimapNmax 20 --outFilterScoreMin 1 --outFilterMatchNmin 1 --outFilterMismatchNmax 2 --chimSegmentMin 15 --chimScoreMin 15 --chimScoreSeparation 10 --chimJunctionOverhangMin 15 --limitBAMsortRAM 512000000000 &>STAR_init_map1_logfile.log

rule _dcc_c_align_primary_STAR_DCC:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_bothlanes.Chimeric.out.junction
    jobid: 39
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_bothlanes.Chimeric.out.junction; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx
    wildcards: name=SRR3184300

STAR --runThreadN 1 --genomeDir /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full --outSAMtype BAM SortedByCoordinate --readFilesIn /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq --outFileNamePrefix SRR3184300_bothlanes. --outReadsUnmapped Fastx --outSJfilterOverhangMin 15 15 15 15 --alignSJoverhangMin 15 --alignSJDBoverhangMin 15 --outFilterMultimapNmax 20 --outFilterScoreMin 1 --outFilterMatchNmin 1 --outFilterMismatchNmax 2 --chimSegmentMin 15 --chimScoreMin 15 --chimScoreSeparation 10 --chimJunctionOverhangMin 15 --limitBAMsortRAM 512000000000 &>STAR_init_map1_logfile.log

rule _dcc_d2_align_mate2:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_2.Chimeric.out.junction
    jobid: 41
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_2.Chimeric.out.junction; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx
    wildcards: name=SRR3184300

STAR --runThreadN 1 --genomeDir /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full --outSAMtype BAM SortedByCoordinate --readFilesIn /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_2.fastq --outFileNamePrefix SRR3184300_2. --outReadsUnmapped Fastx --outSJfilterOverhangMin 15 15 15 15 --alignSJoverhangMin 15 --alignSJDBoverhangMin 15 --seedSearchStartLmax 30 --outFilterMultimapNmax 20 --outFilterScoreMin 1 --outFilterMatchNmin 1 --outFilterMismatchNmax 2 --chimSegmentMin 15 --chimScoreMin 15 --chimScoreSeparation 10 --chimJunctionOverhangMin 15 --limitBAMsortRAM 512000000000 &>STAR_lane1_map1_logfile.log

rule _dcc_d2_align_mate2:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_2.Chimeric.out.junction
    jobid: 37
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_2.Chimeric.out.junction; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx
    wildcards: name=SRR3184285

STAR --runThreadN 1 --genomeDir /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full --outSAMtype BAM SortedByCoordinate --readFilesIn /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_2.fastq --outFileNamePrefix SRR3184285_2. --outReadsUnmapped Fastx --outSJfilterOverhangMin 15 15 15 15 --alignSJoverhangMin 15 --alignSJDBoverhangMin 15 --seedSearchStartLmax 30 --outFilterMultimapNmax 20 --outFilterScoreMin 1 --outFilterMatchNmin 1 --outFilterMismatchNmax 2 --chimSegmentMin 15 --chimScoreMin 15 --chimScoreSeparation 10 --chimJunctionOverhangMin 15 --limitBAMsortRAM 512000000000 &>STAR_lane1_map1_logfile.log

rule _dcc_d1_align_mate1:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_1.Chimeric.out.junction
    jobid: 40
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_1.Chimeric.out.junction; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/chk.tx
    wildcards: name=SRR3184300

STAR --runThreadN 1 --genomeDir /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full --outSAMtype BAM SortedByCoordinate --readFilesIn /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184300_1.fastq --outFileNamePrefix SRR3184300_1. --outReadsUnmapped Fastx --outSJfilterOverhangMin 15 15 15 15 --alignSJoverhangMin 15 --alignSJDBoverhangMin 15 --seedSearchStartLmax 30 --outFilterMultimapNmax 20 --outFilterScoreMin 1 --outFilterMatchNmin 1 --outFilterMismatchNmax 2 --chimSegmentMin 15 --chimScoreMin 15 --chimScoreSeparation 10 --chimJunctionOverhangMin 15 --limitBAMsortRAM 512000000000 &>STAR_lane1_map1_logfile.log

rule _dcc_d1_align_mate1:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_1.Chimeric.out.junction
    jobid: 38
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_1.Chimeric.out.junction; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/chk.tx
    wildcards: name=SRR3184285

STAR --runThreadN 1 --genomeDir /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full --outSAMtype BAM SortedByCoordinate --readFilesIn /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/SRR3184285_1.fastq --outFileNamePrefix SRR3184285_1. --outReadsUnmapped Fastx --outSJfilterOverhangMin 15 15 15 15 --alignSJoverhangMin 15 --alignSJDBoverhangMin 15 --seedSearchStartLmax 30 --outFilterMultimapNmax 20 --outFilterScoreMin 1 --outFilterMatchNmin 1 --outFilterMismatchNmax 2 --chimSegmentMin 15 --chimScoreMin 15 --chimScoreSeparation 10 --chimJunctionOverhangMin 15 --limitBAMsortRAM 512000000000 &>STAR_lane1_map1_logfile.log

rule _r03_create_infile:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/fastq_infiles_list.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/samples.tsv
    jobid: 18
    reason: Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/fastq_infiles_list.tx

 rm /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/samples.tsv && perl scripts/snake_infile_creator.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/fastq_infiles_list.tx --l1 _1 --l2 _2 >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/samples.tsv

rule _cx_d_run_cx2:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/Chimeric.out.junction
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/back_spliced_junction.bed
    jobid: 29
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/back_spliced_junction.bed; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/Chimeric.out.junction
    wildcards: name=SRR3184300

python /home/daric102/.local/bin/CIRCexplorer2 parse -t STAR /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/Chimeric.out.junction >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/CIRCexplorer2_parse.log

rule _cx_d_run_cx2:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/Chimeric.out.junction
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/back_spliced_junction.bed
    jobid: 27
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/back_spliced_junction.bed; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/Chimeric.out.junction
    wildcards: name=SRR3184285

python /home/daric102/.local/bin/CIRCexplorer2 parse -t STAR /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/Chimeric.out.junction >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/CIRCexplorer2_parse.log

rule _dcc_e_execute_dcc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_bothlanes.Chimeric.out.junction, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_1.Chimeric.out.junction, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_2.Chimeric.out.junction
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates
    jobid: 30
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_1.Chimeric.out.junction, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_bothlanes.Chimeric.out.junction, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_2.Chimeric.out.junction
    wildcards: name=SRR3184285

python /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/DCC/main.py /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_bothlanes.Chimeric.out.junction -mt1 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_1.Chimeric.out.junction -mt2 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/SRR3184285_2.Chimeric.out.junction -D -fg -an /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full/hg38_ucsc_ref_new_chroms.gtf -Pi -M -Nr 2 1 -A /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full/hg38_full.fa -N -T 1

rule _dcc_e_execute_dcc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_bothlanes.Chimeric.out.junction, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_1.Chimeric.out.junction, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_2.Chimeric.out.junction
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates
    jobid: 31
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_bothlanes.Chimeric.out.junction, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_1.Chimeric.out.junction, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_2.Chimeric.out.junction
    wildcards: name=SRR3184300

python /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/DCC/main.py /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_bothlanes.Chimeric.out.junction -mt1 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_1.Chimeric.out.junction -mt2 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/SRR3184300_2.Chimeric.out.junction -D -fg -an /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full/hg38_ucsc_ref_new_chroms.gtf -Pi -M -Nr 2 1 -A /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full/hg38_full.fa -N -T 1

rule _fc_d_create_bam:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.sam
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.bam
    jobid: 55
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.bam; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.sam
    wildcards: name=SRR3184285

samtools view -@ 1 -hbuS -o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.bam /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.sam

rule _fc_d_create_bam:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.sam
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.bam
    jobid: 54
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.bam; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.sam
    wildcards: name=SRR3184300

samtools view -@ 1 -hbuS -o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.bam /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.sam

rule _cx_e_annotate_circs:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/back_spliced_junction.bed
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/cx2_out.tsv
    jobid: 20
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/cx2_out.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/back_spliced_junction.bed
    wildcards: name=SRR3184300

python /home/daric102/.local/bin/CIRCexplorer2 annotate -r /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full/hg_38_ref_fetched.txt -g /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full/hg38_full.fa -b /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/back_spliced_junction.bed -o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/cx2_out.tsv

rule _cx_e_annotate_circs:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/back_spliced_junction.bed
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/cx2_out.tsv
    jobid: 17
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/cx2_out.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/back_spliced_junction.bed
    wildcards: name=SRR3184285

python /home/daric102/.local/bin/CIRCexplorer2 annotate -r /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full/hg_38_ref_fetched.txt -g /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg38_full/hg38_full.fa -b /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/back_spliced_junction.bed -o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/cx2_out.tsv

rule _dcc_f_cleanup_circfile:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_clean, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates_clean
    jobid: 21
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates_clean, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_clean; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount
    wildcards: name=SRR3184285

cat /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount | sed '1d' >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_clean && cat /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates | sed '1d' >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates_clean

rule _dcc_f_cleanup_circfile:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_clean, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates_clean
    jobid: 23
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_clean, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates_clean; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates
    wildcards: name=SRR3184300

cat /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount | sed '1d' >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_clean && cat /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates | sed '1d' >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates_clean

rule _fc_e_sort_bam:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.bam
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto.bam
    jobid: 52
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto.bam; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.bam
    wildcards: name=SRR3184300

samtools sort @ 1 -O bam -o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto.bam /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/temp.bam

rule _r04_count_reads_fastqs:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/samples.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/fastq_infiles_list.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv
    jobid: 11
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/fastq_infiles_list.tx, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/samples.tsv

perl scripts/fastq_list_to_reads_per_sample.pl --l1 _1 --i fastq_list_file >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv

rule _fc_e_sort_bam:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.bam
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto.bam
    jobid: 53
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto.bam; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.bam
    wildcards: name=SRR3184285

samtools sort @ 1 -O bam -o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto.bam /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/temp.bam

rule _cx_f_cleanup_cx2anot:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/cx2_out.tsv
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/processed_run_SRR3184300.tsv
    jobid: 12
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/processed_run_SRR3184300.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/cx2_out.tsv
    wildcards: name=SRR3184300

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/circexplorer1_auto/circexplorer1_out_reader.pl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/cx2_out.tsv /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/processed_run_SRR3184300.tsv SRR3184300

rule _dcc_g_annotate_cleanfile:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_clean
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_annotated.tsv
    jobid: 24
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_annotated.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_clean
    wildcards: name=SRR3184300

bedtools window -a /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_clean -b /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/upd/hg38_ucsc_refseq.bed -w 1 >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_annotated.tsv

rule _cx_f_cleanup_cx2anot:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/cx2_out.tsv
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/processed_run_SRR3184285.tsv
    jobid: 10
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/processed_run_SRR3184285.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/cx2_out.tsv
    wildcards: name=SRR3184285

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/circexplorer1_auto/circexplorer1_out_reader.pl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/cx2_out.tsv /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/processed_run_SRR3184285.tsv SRR3184285

rule _dcc_g_annotate_cleanfile:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_clean
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_annotated.tsv
    jobid: 22
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_annotated.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_clean
    wildcards: name=SRR3184285

bedtools window -a /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_clean -b /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/upd/hg38_ucsc_refseq.bed -w 1 >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_annotated.tsv

rule _fc_f_prepare_remapping:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto.bam
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.unmapped.auto.bam
    jobid: 51
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.unmapped.auto.bam; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto.bam
    wildcards: name=SRR3184285

samtools view -@ 1 -hf 4 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto.bam | samtools view -@ 1 -Sb - > /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.unmapped.auto.bam

rule _fc_f_prepare_remapping:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto.bam
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.unmapped.auto.bam
    jobid: 50
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.unmapped.auto.bam; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto.bam
    wildcards: name=SRR3184300

samtools view -@ 1 -hf 4 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto.bam | samtools view -@ 1 -Sb - > /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.unmapped.auto.bam

rule _fc_g_get_anchors:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.unmapped.auto.bam
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto_anchors.qfa
    jobid: 49
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto_anchors.qfa; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.unmapped.auto.bam
    wildcards: name=SRR3184285

python 2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/unmapped2anchors.py /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.unmapped.auto.bam >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto_anchors.qfa

rule _fc_g_get_anchors:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.unmapped.auto.bam
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto_anchors.qfa
    jobid: 48
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto_anchors.qfa; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.unmapped.auto.bam
    wildcards: name=SRR3184300

python 2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/unmapped2anchors.py /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.unmapped.auto.bam >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto_anchors.qfa

rule _dcc_h_cleanup_annotation:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_annotated.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates_clean
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/processed_run_SRR3184300.tsv
    jobid: 14
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/processed_run_SRR3184300.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates_clean, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_annotated.tsv
    wildcards: name=SRR3184300

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/automate_DCC/dcc_outreader.pl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircRNACount_annotated.tsv /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/CircCoordinates_clean /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/processed_run_SRR3184300.tsv SRR3184300

rule _dcc_h_cleanup_annotation:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_annotated.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates_clean
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/processed_run_SRR3184285.tsv
    jobid: 13
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/processed_run_SRR3184285.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates_clean, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_annotated.tsv
    wildcards: name=SRR3184285

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/automate_DCC/dcc_outreader.pl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircRNACount_annotated.tsv /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/CircCoordinates_clean /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/processed_run_SRR3184285.tsv SRR3184285

rule _r05c_collect_tsvs_cx:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/processed_run_SRR3184300.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/processed_run_SRR3184285.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.tx
    jobid: 7
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.tx; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/processed_run_SRR3184285.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/processed_run_SRR3184300.tsv

cat /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184300/processed_run_SRR3184300.tsv /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/run_SRR3184285/processed_run_SRR3184285.tsv >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.tx

rule _r05b_collect_tsvs_dc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/processed_run_SRR3184300.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/processed_run_SRR3184285.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.tx
    jobid: 8
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.tx; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/processed_run_SRR3184285.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/processed_run_SRR3184300.tsv

cat /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184300/processed_run_SRR3184300.tsv /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/run_SRR3184285/processed_run_SRR3184285.tsv >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.tx

rule _r06c_run_matrixmaker_cx:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.mat1
    jobid: 4
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.mat1; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.tx

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/matrixmaker-V4.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.tx --o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.mat1 --c /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/hg_38_circbase_known_circs.bed --g /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/refseq_to_gene_names_hg38.tsv

rule _fc_h_align_anchors:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto_anchors.qfa
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.sites.bed, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.sites.reads, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.secondpass.log, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.f_c_run_sites.log
    jobid: 43
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.sites.bed; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto_anchors.qfa
    wildcards: name=SRR3184285

bowtie2 --reorder --mm --score-min=C,-15,0 -q -x /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg19 -U /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.auto_anchors.qfa 2> /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.secondpass.log | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/find_circ.py -G /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/upd/all_chroms -p SRR3184285 -s /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.f_c_run_sites.log > /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.sites.bed 2> /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.sites.reads

rule _fc_h_align_anchors:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto_anchors.qfa
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.sites.bed, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.sites.reads, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.secondpass.log, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.f_c_run_sites.log
    jobid: 42
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.sites.bed; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto_anchors.qfa
    wildcards: name=SRR3184300

bowtie2 --reorder --mm --score-min=C,-15,0 -q -x /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/hg19 -U /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.auto_anchors.qfa 2> /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.secondpass.log | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/find_circ.py -G /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/upd/all_chroms -p SRR3184300 -s /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.f_c_run_sites.log > /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.sites.bed 2> /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.sites.reads

rule _r07c_run_matrix2_cx:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.mat1
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2.mat2
    jobid: 1
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2.mat2; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.mat1

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/matrixtwo_V4.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2_tsvs.mat1 --o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2.mat2 --m /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/miRNA_circRNA_ineractions.txt --c /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/circRNA_protein_coding_potential.txt --h /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/hallmark_genes.tsv --e /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/mart_export_ensembl_gene_desc.txt --n /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/read_mapping.pl --e /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/mart_export_ensembl_gene_desc.txt --excl_cb 1

rule _r06b_run_matrixmaker_dc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.mat1
    jobid: 5
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.mat1; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.tx

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/matrixmaker-V4.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.tx --o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.mat1 --c /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/hg_38_circbase_known_circs.bed --g /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/refseq_to_gene_names_hg38.tsv

rule _fc_i_filter_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.sites.bed
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed
    jobid: 33
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.sites.bed
    wildcards: name=SRR3184285

grep circ /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.sites.bed | grep -v chrM | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/sum.py -2,3 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py -16 1 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py -15 2 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py -14 2 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py 7 2 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py 8,9 35 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py -17 100000 >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed 

rule _fc_i_filter_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.sites.bed
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed
    jobid: 32
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.sites.bed
    wildcards: name=SRR3184300

grep circ /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.sites.bed | grep -v chrM | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/sum.py -2,3 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py -16 1 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py -15 2 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py -14 2 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py 7 2 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py 8,9 35 | python2.7 /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/scorethresh.py -17 100000 >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed 

rule _fc_j_annotate_candidates_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed.annotated
    jobid: 25
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed.annotated; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed
    wildcards: name=SRR3184300

bedtools window -a /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed -b /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/upd/hg38_ucsc_refseq.bed -w 1 >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed.annotated

rule _r07b_run_matrix2_dc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.mat1
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2.mat2
    jobid: 2
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2.mat2; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.mat1

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/matrixtwo_V4.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2_tsvs.mat1 --o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2.mat2 --m /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/miRNA_circRNA_ineractions.txt --c /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/circRNA_protein_coding_potential.txt --h /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/hallmark_genes.tsv --e /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/mart_export_ensembl_gene_desc.txt --n /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/read_mapping.pl --e /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/mart_export_ensembl_gene_desc.txt --excl_cb 1

rule _fc_j_annotate_candidates_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed.annotated
    jobid: 26
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed.annotated; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed
    wildcards: name=SRR3184285

bedtools window -a /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed -b /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/upd/hg38_ucsc_refseq.bed -w 1 >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed.annotated

rule _fc_k_reformat_circs:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed.annotated
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/processed_run_SRR3184285.tsv
    jobid: 16
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/processed_run_SRR3184285.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed.annotated
    wildcards: name=SRR3184285

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/f_c_outreader.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/SRR3184285.circ_candidates_auto.bed.annotated --o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/processed_run_SRR3184285.tsv -strict 0

rule _fc_k_reformat_circs:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed.annotated
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/processed_run_SRR3184300.tsv
    jobid: 15
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/processed_run_SRR3184300.tsv; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed.annotated
    wildcards: name=SRR3184300

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/f_c_outreader.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/SRR3184300.circ_candidates_auto.bed.annotated --o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/processed_run_SRR3184300.tsv -strict 0

rule _r05a_collect_tsvs_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/processed_run_SRR3184300.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/processed_run_SRR3184285.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.tx
    jobid: 9
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.tx; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/processed_run_SRR3184300.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/processed_run_SRR3184285.tsv, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/reads_per_sample_test_srr_2samples.tsv

cat /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184300/processed_run_SRR3184300.tsv /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/run_SRR3184285/processed_run_SRR3184285.tsv >/gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.tx

rule _r06a_run_matrixmaker_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.tx
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.mat1
    jobid: 6
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.mat1; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.tx

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/matrixmaker-V4.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.tx --o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.mat1 --c /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/hg_38_circbase_known_circs.bed --g /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/refseq_to_gene_names_hg38.tsv

rule _r07a_run_matrix2_fc:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.mat1
    output: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2.mat2
    jobid: 3
    reason: Missing output files: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2.mat2; Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.mat1

perl /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/matrixtwo_V4.pl --i /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2_tsvs.mat1 --o /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2.mat2 --m /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/miRNA_circRNA_ineractions.txt --c /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/pipelines/circRNA_protein_coding_potential.txt --h /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/hallmark_genes.tsv --e /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/mart_export_ensembl_gene_desc.txt --n /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/read_mapping.pl --e /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/auto_find_circ/mart_export_ensembl_gene_desc.txt --excl_cb 1

localrule all:
    input: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2.mat2, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2.mat2, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2.mat2
    jobid: 0
    reason: Input files updated by another job: /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/cx2_out/test_srr_2samples/all_test_srr_2samples_cx2.mat2, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/dcc_2_out/test_srr_2samples/all_test_srr_2samples_dcc2.mat2, /gpfs/project/daric102/circs_hilbert_scratchgs/repo/circs/f_c2_out/test_srr_2samples/all_test_srr_2samples_fc2.mat2

Job counts:
	count	jobs
	2	_cx_b_prepare_files
	2	_cx_c_align_primary_STAR
	2	_cx_d_run_cx2
	2	_cx_e_annotate_circs
	2	_cx_f_cleanup_cx2anot
	2	_dcc_b_prepare_files_dcc
	2	_dcc_c_align_primary_STAR_DCC
	2	_dcc_d1_align_mate1
	2	_dcc_d2_align_mate2
	2	_dcc_e_execute_dcc
	2	_dcc_f_cleanup_circfile
	2	_dcc_g_annotate_cleanfile
	2	_dcc_h_cleanup_annotation
	2	_fc_b_prepare_files_fc
	2	_fc_c_map_primary_bt2
	2	_fc_d_create_bam
	2	_fc_e_sort_bam
	2	_fc_f_prepare_remapping
	2	_fc_g_get_anchors
	2	_fc_h_align_anchors
	2	_fc_i_filter_fc
	2	_fc_j_annotate_candidates_fc
	2	_fc_k_reformat_circs
	1	_r01_prepare_hg38_dirs
	1	_r02_create_fastq_list
	1	_r03_create_infile
	1	_r04_count_reads_fastqs
	1	_r05a_collect_tsvs_fc
	1	_r05b_collect_tsvs_dc
	1	_r05c_collect_tsvs_cx
	1	_r06a_run_matrixmaker_fc
	1	_r06b_run_matrixmaker_dc
	1	_r06c_run_matrixmaker_cx
	1	_r07a_run_matrix2_fc
	1	_r07b_run_matrix2_dc
	1	_r07c_run_matrix2_cx
	1	all
	60
